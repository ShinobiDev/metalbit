ALTER TABLE `recargas` CHANGE `user_id` `user_id` INT UNSIGNED NOT NULL;
ALTER TABLE `recargas` ADD  CONSTRAINT `fk_recarga_user` FOREIGN KEY (`user_id`) REFERENCES `users`(`id`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `users` ADD `calificacion` INT NOT NULL DEFAULT '0' AFTER `updated_at`, ADD `num_calificaciones` INT NOT NULL DEFAULT '0' AFTER `calificacion`;
ALTER TABLE `anuncios` CHANGE `user_id` `user_id` INT(11) UNSIGNED NOT NULL;
ALTER TABLE `detalle_clic_anuncios` ADD  CONSTRAINT `fk_id_user` FOREIGN KEY (`id_usuario`) REFERENCES `users`(`id`) ON DELETE RESTRICT ON UPDATE RESTRICT;
ALTER TABLE `detalle_clic_anuncios` ADD CONSTRAINT `fk_id_ad` FOREIGN KEY (`id_anuncio`) REFERENCES `anuncios`(`id`) ON DELETE RESTRICT ON UPDATE RESTRICT
ALTER TABLE `detalle_recargas` CHANGE `id_user` `id_user` INT(11) UNSIGNED NOT NULL;
ALTER TABLE `detalle_recargas` CHANGE `referencia_pago_pay_u` `referencia_pago_pay_u` VARCHAR(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL;
ALTER TABLE `detalle_recargas` ADD UNIQUE(`referencia_pago_pay_u`);
ALTER TABLE `detalle_recargas` ADD INDEX(`id_user`);
ALTER TABLE `detalle_recargas` ADD CONSTRAINT `fk_id_user_recarga` FOREIGN KEY (`id_user`) REFERENCES `users`(`id`) ON DELETE RESTRICT ON UPDATE RESTRICT;
ALTER TABLE `detalle_referidos` ADD INDEX(`id_referido`);
ALTER TABLE `detalle_referidos` ADD INDEX(`id_quien_refiere`);
ALTER TABLE `detalle_referidos` CHANGE `id_referido` `id_referido` INT(11) UNSIGNED NOT NULL, CHANGE `id_quien_refiere` `id_quien_refiere` INT(11) UNSIGNED NOT NULL;
ALTER TABLE `detalle_referidos` ADD CONSTRAINT `fk_id_user_referido` FOREIGN KEY (`id_referido`) REFERENCES `users`(`id`) ON DELETE RESTRICT ON UPDATE RESTRICT;
ALTER TABLE `detalle_referidos` ADD CONSTRAINT `fk_id_referido` FOREIGN KEY (`id_referido`) REFERENCES `users`(`id`) ON DELETE RESTRICT ON UPDATE RESTRICT;
ALTER TABLE `pagos` ADD  CONSTRAINT `fk_id_anuncio` FOREIGN KEY (`id_anuncio`) REFERENCES `anuncios`(`id`) ON DELETE RESTRICT ON UPDATE RESTRICT;
ALTER TABLE `pagos` ADD CONSTRAINT `fk_id_user_compra` FOREIGN KEY (`id_user_compra`) REFERENCES `users`(`id`) ON DELETE RESTRICT ON UPDATE RESTRICT;
ALTER TABLE `recargas` ADD CONSTRAINT `fk_id_user_rec` FOREIGN KEY (`user_id`) REFERENCES `users`(`id`) ON DELETE RESTRICT ON UPDATE RESTRICT;
ALTER TABLE `anuncios` ADD CONSTRAINT `fk_id_user_ad` FOREIGN KEY (`user_id`) REFERENCES `users`(`id`) ON DELETE RESTRICT ON UPDATE RESTRICT;
ALTER TABLE `detalle_recargas` ADD `tipo_recarga` ENUM('PAGO','BONIFICACION') NOT NULL AFTER `id_user`;
ALTER TABLE `payus` ADD `type` ENUM('TEST','PRODUCTION') NOT NULL AFTER `tel_contacto`;

